{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport { useFormContext } from \"react-hook-form\";\nimport Link from 'next/link';\nimport style from './marketing-consent.module.scss';\nimport { EmailAddressIsValid } from 'helpers/validation';\nimport { MarketingCommunicationsService } from 'business-logic/marketingCommunicationsService';\nimport { GetPhoneNumber } from 'helpers/helpers';\nimport { connect } from 'react-redux';\n\nconst MarketingConsent = ({\n  isInternal,\n  emailAddress,\n  settings\n}) => {\n  //Used to share \"privacyConfirmed\" field with parent form and use same validation\n  const formContext = useFormContext(); //Set only when email address is present and marketing consent wasn't accepted earlier\n\n  const {\n    0: isRequired,\n    1: setIsRequired\n  } = useState(false); //Should trigger only when email address is changed\n\n  useEffect(() => {\n    //do we need timeout here?\n    if (settings.onVerificationStart) {\n      settings.onVerificationStart();\n    }\n\n    if (emailAddress && EmailAddressIsValid(emailAddress)) {\n      MarketingCommunicationsService.HasSeenMarketingForm(emailAddress).then(result => {\n        setIsRequired(!result);\n\n        if (settings.onVerificationComplete) {\n          settings.onVerificationComplete();\n        }\n      });\n    } else {\n      setIsRequired(false);\n\n      if (settings.onVerificationComplete) {\n        settings.onVerificationComplete();\n      }\n    }\n  }, [emailAddress]); //TODO: check if phone number should be dynamic here?\n\n  if (isRequired) {\n    return /*#__PURE__*/_jsx(\"div\", {\n      className: \"form-group\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: style['marketing'],\n        children: [/*#__PURE__*/_jsx(\"h4\", {\n          children: \"Marketing Communications\"\n        }), /*#__PURE__*/_jsx(\"p\", {\n          className: \"mb-4\",\n          children: \"We would love to keep you updated with our latest special offers, car news and exclusive benefits just for Leasing Options customers. Please let us know how you'd like us to contact you:\"\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: `${style[\"checkboxes\"]} mb-4`,\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"form-check form-check-inline\",\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              className: \"form-check-input\",\n              type: \"checkbox\",\n              name: \"allowedCommunicationTypes\",\n              value: 1,\n              id: \"contactEmail\",\n              ref: formContext.register\n            }), /*#__PURE__*/_jsx(\"label\", {\n              className: \"form-check-label mb-0\",\n              htmlFor: \"contactEmail\",\n              children: \"Email\"\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"form-check form-check-inline\",\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              className: \"form-check-input\",\n              type: \"checkbox\",\n              name: \"allowedCommunicationTypes\",\n              value: 2,\n              id: \"contactPost\",\n              ref: formContext.register\n            }), /*#__PURE__*/_jsx(\"label\", {\n              className: \"form-check-label mb-0\",\n              htmlFor: \"contactPost\",\n              children: \"Post\"\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"form-check form-check-inline\",\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              className: \"form-check-input\",\n              type: \"checkbox\",\n              name: \"allowedCommunicationTypes\",\n              value: 3,\n              id: \"contactSms\",\n              ref: formContext.register\n            }), /*#__PURE__*/_jsx(\"label\", {\n              className: \"form-check-label mb-0\",\n              htmlFor: \"contactSms\",\n              children: \"SMS\"\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"form-check form-check-inline\",\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              className: \"form-check-input\",\n              type: \"checkbox\",\n              name: \"allowedCommunicationTypes\",\n              value: 4,\n              id: \"contactPhone\",\n              ref: formContext.register\n            }), /*#__PURE__*/_jsx(\"label\", {\n              className: \"form-check-label mb-0\",\n              htmlFor: \"contactPhone\",\n              children: \"Telephone\"\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"form-check form-check-inline\",\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              className: \"form-check-input\",\n              type: \"checkbox\",\n              name: \"allowedCommunicationTypes\",\n              value: 5,\n              id: \"contactWhatsApp\",\n              ref: formContext.register\n            }), /*#__PURE__*/_jsx(\"label\", {\n              className: \"form-check-label mb-0\",\n              htmlFor: \"contactWhatsApp\",\n              children: \"WhatsApp\"\n            })]\n          })]\n        }), /*#__PURE__*/_jsxs(\"p\", {\n          className: \"mb-4\",\n          children: [\"Your personal information will not be shared with any third party companies. For more information, please read our Privacy Policy \", /*#__PURE__*/_jsx(Link, {\n            href: \"/privacy-policy\",\n            children: /*#__PURE__*/_jsx(\"a\", {\n              children: \"here\"\n            })\n          }), \" for further details. You can unsubscribe from marketing communications at any time by contacting us on \", /*#__PURE__*/_jsx(\"strong\", {\n            children: /*#__PURE__*/_jsx(\"span\", {\n              className: \"phonenumber_call_now\",\n              children: GetPhoneNumber(isInternal)\n            })\n          }), \" or via Email at \", /*#__PURE__*/_jsx(\"a\", {\n            href: \"mailto:marketing@leasingoptions.co.uk\",\n            children: \"marketing@leasingoptions.co.uk\"\n          })]\n        })]\n      })\n    });\n  }\n\n  return null;\n};\n\nconst mapStateToProps = state => ({\n  isInternal: state.isInternal\n});\n\nexport default connect(mapStateToProps)(MarketingConsent);","map":null,"metadata":{},"sourceType":"module"}